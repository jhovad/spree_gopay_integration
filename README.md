SpreeGopayIntegration
=====================

Spree integration with GoPay offsite payment gateway.

**note: This is my very first gem for my first project with Spree, so please have an understanding if something is not perfect. Your contribution or advice what to improve is very welcome!**

- Support only for the standard payment (https://doc.gopay.com/en/#standard-payment)
- Inline payment gateway is working only on https sites (on http works with redirect)
- There is avialable only the "Variant A" of EET handling (https://help.gopay.com/cs/tema/propojeni-do-eet/jak-funguje-napojeni-gopay-do-eet#zakladni) for the stores from Czech Republic.

## Installation

1. Add this extension to your Gemfile with this line:
  ```ruby
  gem 'spree_gopay_integration', github: '[your-github-handle]/spree_gopay_integration'
  ```

2. Install the gem using Bundler:
  ```ruby
  bundle install
  ```

3. Copy & run migrations
  ```ruby
  bundle exec rails g spree_gopay_integration:install
  ```

4. Config your Gopay account

  Don't forget to insert seller account details into `config/initializers/gopay.rb`

5. Restart your server

  If your server was running, restart it so that it can find the assets properly.

## Customisation

Payment button (and the information about payment status) is added via Deface (so you can adjust the placement of button with your own Deface rule) on the orders#show page:
```ruby
Deface::Override.new( :virtual_path => "spree/orders/show",
                      :insert_before => "#order",
                      :name => 'add_gopay_payment_button',
                      :partial => "spree/orders/gopay_status" )
```
You can also simply adjust this partial by creating your own one in app/views/spree/orders/_gopay_status.html.erb .

## Testing

**!!! NO SPECS, YOUR CONTRIBUTION IS VERY WELCOME!**

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

```shell
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories.
Simply add this require statement to your spec_helper:

```ruby
require 'spree_gopay_integration/factories'
```


## Contributing

If you'd like to contribute, please take a look at the
[instructions](CONTRIBUTING.md) for installing dependencies and crafting a good
pull request.

Copyright (c) 2017 Josef Hovad / Nobord s.r.o., released under the New BSD License
